/* (c) Copyright 2007-2011 Xoron GmbH */
"use strict";var color_picker={};(function(){var c=360;var r=100;var B=100;var o=165;var u=166;var b=4;var A=2;var x="0084ffff";var k=1;var v;var l;var t;var m;color_picker.initialize=function(){s();color_picker.set_hex_color(x);jQuery("#sv_box").on("mousedown",z);jQuery("#hue_form").on("mousedown",d);m=jQuery("#plugin")};color_picker.set_hex_color=function(D){var E=h(D);v=y(E);p();image_editor.set_transparency(E[3])};color_picker.color_popup=function(){var D=window.prompt("Color in hex format:",n(v));var E=/^[0-9a-f]{6}$/i;if(E.test(D)){D+="ff";color_picker.set_hex_color(D)}};function z(D){return e("saturation_value_slider",D)}function d(D){return e("hue_slider",D)}function s(){var E="";for(var D=o;D>=0;D--){E+='<div style="BACKGROUND: #'+n([Math.round((360/o)*D),100,100])+';"><br /></div>'}jQuery("#hue_box").html(E)}function i(F,D,G){var E=Math.round((G/D)*F);E=f(E,0,F);return(E)}function f(D,E,F){if(D>F){return(F)}else{if(D<E){return(E)}}return(D)}function C(E){var D=Math.round(v[1]/r*u);var G=Math.round(u-v[2]/B*u);var F=Math.round(o-v[0]/c*o);jQuery("#saturation_value_slider").css("left",(D-b)+"px");jQuery("#saturation_value_slider").css("top",(G-b)+"px");jQuery("#hue_slider").css("top",(F-A-5)+"px")}function w(D){j(D.data.which_slider,D.pageX,D.pageY);return(false)}function j(E,F,H){if(!k){var K=F-l;var I=H-t;if(E==="saturation_value_slider"){var D=f(K,0,u);var J=f(I,0,u);v[1]=i(r,u,D);v[2]=B-i(B,u,J);p()}else{if(E==="hue_slider"){var G=f(I,0,o);v[0]=c-i(c,o,G);p()}}}}function e(E,F){if(k){k=0;var D=m.offset();l=D.left+10;t=D.top+22;jQuery(document).on("mousemove",{which_slider:E},w);jQuery(document).on("mouseup",function(){k=1;jQuery(document).off("mousemove",w);jQuery(document).off("mouseup",w)});j(E,F.pageX,F.pageY)}image_editor.pen_selected();return(false)}function p(){jQuery("#sv_box").css("backgroundColor","#"+n([v[0],100,100]));C(v);var D=n(v);jQuery("#color_hex_string").html(D);jQuery("#current_color_box").css("background","#"+D);jQuery("#big_current_color_box").css("background","#"+D);image_editor.change_last_used_colors();return(D)}function q(D){D=Math.round(Math.min(Math.max(0,D),255));return("0123456789ABCDEF".charAt((D-D%16)/16)+"0123456789ABCDEF".charAt(D%16))}function a(D){return(q(D[0])+q(D[1])+q(D[2]))}function h(F){var H=parseInt(F.charAt(0)+F.charAt(1),16);var G=parseInt(F.charAt(2)+F.charAt(3),16);var D=parseInt(F.charAt(4)+F.charAt(5),16);var E=parseInt(F.charAt(6)+F.charAt(7),16);return([H,G,D,E])}function n(D){return(a(g(D)))}function g(P){var L;var N;var E;var M=P[0]/360;var K=P[1]/100;var J=P[2]/100;if(K>0){if(M>=1){M=0}M=6*M;var O=M-Math.floor(M);var I=Math.round(255*J*(1-K));E=Math.round(255*J*(1-(K*O)));var D=Math.round(255*J*(1-(K*(1-O))));J=Math.round(255*J);switch(Math.floor(M)){case 0:L=J;N=D;E=I;break;case 1:L=E;N=J;E=I;break;case 2:L=I;N=J;E=D;break;case 3:L=I;N=E;E=J;break;case 4:L=D;N=I;E=J;break;case 5:L=J;N=I;E=E;break}return([L?L:0,N?N:0,E?E:0])}else{return([(J=Math.round(J*255)),J,J])}}function y(N){var M=(N[0]/255);var D=(N[1]/255);var G=(N[2]/255);var L=Math.min(M,D,G);var R=Math.max(M,D,G);var O=R-L;var E=R;var Q;var I;if(O===0){var K=y(h(x));Q=K[0]/c;I=0}else{I=O/R;var P=(((R-M)/6)+(O/2))/O;var F=(((R-D)/6)+(O/2))/O;var J=(((R-G)/6)+(O/2))/O;if(M===R){Q=J-F}else{if(D===R){Q=(1/3)+P-J}else{if(G===R){Q=(2/3)+F-P}}}if(Q<0){Q+=1}if(Q>1){Q-=1}}return([Q*c,I*r,E*B])}}());